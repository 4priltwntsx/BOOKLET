# 이미지 기반 머신러닝

## 이미지 분류(라벨링)가 필요한 이유

- 라벨링 없이 단순 이미지를 이용한 머신러닝은 정확도가 상당히 떨어지는 문제가 있다.
  - 컴퓨터는 기본적으로 이미지를 구성하는 요소, 구도 등에 대한 정보를 이해하지 못하므로, 개별 픽셀의 정보(RGB 등)에 기반하여 분류한다.
  - 사물, 조형물, 배경, 구도 등을 기준으로 이미지를 분류하려면 '이 부분은 어떤 내용이다' 라는 설명이 필요하다.

# YOLOv5 사용

- YOLO는 You Only Look Once의 약자로, 모델은 학습 단계에서 같은 이미지 데이터를 _한 번만_ 학습한다.

## YOLOv5를 사용하는 이유

- YOLOv5는 실시간 서비스 환경에서 시각 데이터(이미지, 동영상 포함)를 효율적으로 처리할 수 있다는 장점이 있다.
- 다만 Tensorflow, Scikit-learn 등 ML 특화 오픈소스보다 정확도가 떨어진다는 문제점이 있다.
- 표지 기반 도서 추천 서비스는 스마트폰 카메라로 촬영한 데이터를 기반으로 추천할 수 있도록 준비하기 위해 **(서비스의 확장성을 고려하여)** YOLOv5를 사용했다.
- 정확도 문제는 라벨링 분류를 정교하게 하고, 학습 데이터 풀을 늘리는 방식으로 해결하려 한다.

## YOLO

- YOLOv5에 사용할 라벨링 데이터는 YOLO를 이용하여 생성한다.

# YOLOv5 사용 과정에서 직면한 문제

1. 라벨링 기준의 모호함

- 머신러닝 성능을 테스트할 때 사용한 라벨링 클래스(분류 기준)는 클래스 간 분류 기준이 모호한 경우가 많았다.
  - 클래스 카테고리 중에 만화, 동화, 상상화가 있는데, 어린 독자를 대상으로 한 만화책의 표지는 세 가지 카테고리에 모두 해당했다.
  - 동일한 이미지를 해당하는 카테고리마다 중복해서 설정하는 경우 분류 정확도에 부정적인 영향을 주는 문제가 있었다.

2. 라벨링 샘플의 표본 편중

- 라벨링한 항목들이 특정 클래스(만화)로 편중되는 현상이 발생했다.
- 위의 _모호한 기준_ 에 해당하는 경우 모두 만화로 분류하다 보니, 특정 카테고리에 데이터가 편중되는 문제가 발생했다.
  - 그 결과 만화 이미지에 대한 정확도는 높았지만, 그 외의 카테고리에 해당하는 이미지는 정확도가 다소 떨어졌다.

3. GPU 사용 시 에러 발생

- GPU를 사용하여 이미지 분석 모델 학습 시도 시 메모리 부족(torch.cuda.OutOfMemoryError) 에러가 발생했다.
- 분석 모델을 변경하자 NotImplementedError가 발생했다.

# 문제 해결 방안

### 문제 1, 2에 대한 해결 방안

- 클래스 항목들 간 중복 없이 가능한 명확히 구분될 수 있도록, 라벨링 기준을 새로 마련했다.

### 문제 3 해결 방안

- 시스템의 그래픽 성능에 맞는 모델로 변경하고, 이미지 사이즈와 batch 크기를 감소하여 리소스 사용량을 감소시켰다.
- NotImplementedError는 pytorch와 torchvision을 재설치하여 해결했다.
